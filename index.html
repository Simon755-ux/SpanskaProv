<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spanska VerbÃ¶vningar Ã…k 9</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .screen {
            display: none;
            padding: 30px;
        }
        
        .screen.active {
            display: block;
        }
        
        .mode-selector {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .mode-btn {
            padding: 15px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .mode-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: scale(1.05);
        }
        
        .mode-btn:not(.active) {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }
        
        .mode-btn:hover:not(.active) {
            background: #667eea;
            color: white;
        }
        
        .section-list {
            display: grid;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .section-checkbox {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .section-checkbox:hover {
            background: #e9ecef;
            border-color: #667eea;
        }
        
        .section-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            cursor: pointer;
        }
        
        .section-checkbox label {
            cursor: pointer;
            flex: 1;
            font-size: 1.1em;
        }
        
        .btn {
            padding: 15px 40px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            display: inline-block;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .text-center {
            text-align: center;
        }
        
        .question-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }
        
        .progress-text {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.1em;
            color: #666;
        }
        
        .question-section {
            font-size: 0.9em;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .question-text {
            font-size: 1.3em;
            margin-bottom: 15px;
            color: #333;
        }
        
        .question-hint {
            color: #666;
            font-style: italic;
            margin-bottom: 20px;
        }
        
        .answer-input {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            border: 2px solid #ddd;
            border-radius: 10px;
            transition: border-color 0.3s;
            margin-bottom: 15px;
        }
        
        .answer-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .answer-input.correct {
            border-color: #28a745;
            background: #d4edda;
        }
        
        .answer-input.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
        }
        
        .feedback {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1.1em;
            display: none;
        }
        
        .feedback.show {
            display: block;
        }
        
        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }
        
        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }
        
        .attempts {
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.1em;
            color: #666;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .results-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .results-score {
            font-size: 2.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .results-message {
            font-size: 1.3em;
            color: #666;
            margin-bottom: 20px;
        }
        
        .results-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-box {
            background: white;
            padding: 15px;
            border-radius: 10px;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        
        .select-all {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .select-all button {
            margin: 0 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ‡ªðŸ‡¸ Spanska VerbÃ¶vningar Ã…k 9 ðŸ‡ªðŸ‡¸</h1>
            <p>Kapitel 4 - Ã–vning gÃ¶r mÃ¤stare!</p>
        </div>
        
        <!-- Meny Screen -->
        <div id="menuScreen" class="screen active">
            <h2 class="text-center" style="margin-bottom: 30px; color: #667eea;">VÃ¤lj spellÃ¤ge</h2>
            <div class="mode-selector">
                <button class="mode-btn active" onclick="selectMode('verbs')">VerbbÃ¶jningar</button>
                <button class="mode-btn" onclick="selectMode('translations')">Ã–versÃ¤ttningar</button>
            </div>
        </div>
        
        <!-- Urvals Screen -->
        <div id="selectionScreen" class="screen">
            <h2 class="text-center" style="margin-bottom: 20px; color: #667eea;">VÃ¤lj Ã¶vningar</h2>
            
            <div class="select-all">
                <button class="btn btn-secondary" onclick="selectAll()">Markera alla</button>
                <button class="btn btn-secondary" onclick="deselectAll()">Avmarkera alla</button>
            </div>
            
            <div id="sectionList" class="section-list"></div>
            
            <div class="controls">
                <button class="btn btn-secondary" onclick="backToMenu()">Tillbaka</button>
                <button class="btn btn-primary" onclick="startExercise()" id="startBtn">Starta Ã¶vning</button>
            </div>
        </div>
        
        <!-- Ã–vnings Screen -->
        <div id="exerciseScreen" class="screen">
            <div class="progress-text" id="progressText"></div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <div class="question-card">
                <div class="question-section" id="questionSection"></div>
                <div class="question-text" id="questionText"></div>
                <div class="question-hint" id="questionHint"></div>
                
                <div class="attempts" id="attemptsText"></div>
                
                <input type="text" class="answer-input" id="answerInput" placeholder="Skriv ditt svar hÃ¤r...">
                
                <div class="feedback" id="feedback"></div>
                
                <div class="controls">
                    <button class="btn btn-primary" onclick="checkAnswer()" id="checkBtn">Kontrollera</button>
                    <button class="btn btn-primary" onclick="nextQuestion()" id="nextBtn" style="display: none;">NÃ¤sta</button>
                </div>
            </div>
        </div>
        
        <!-- Resultat Screen -->
        <div id="resultsScreen" class="screen">
            <div class="results-card">
                <div class="results-score" id="resultsScore"></div>
                <div class="results-message" id="resultsMessage"></div>
                
                <div class="results-stats">
                    <div class="stat-box">
                        <div class="stat-number" id="totalQuestions">0</div>
                        <div class="stat-label">Totalt frÃ¥gor</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="correctAnswers">0</div>
                        <div class="stat-label">RÃ¤tt</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="wrongAnswers">0</div>
                        <div class="stat-label">Fel</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="firstTryCorrect">0</div>
                        <div class="stat-label">RÃ¤tt fÃ¶rsta gÃ¥ngen</div>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn btn-secondary" onclick="backToMenu()">Meny</button>
                <button class="btn btn-primary" onclick="restartAll()">Starta om alla</button>
                <button class="btn btn-primary" onclick="restartWrong()" id="restartWrongBtn">Starta om felen</button>
            </div>
        </div>
    </div>

    <script>
        let currentMode = 'verbs';
        let selectedSections = [];
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let attempts = 0;
        let stats = {
            total: 0,
            correct: 0,
            wrong: 0,
            firstTry: 0,
            wrongQuestions: []
        };
        
        const verbExercises = [
            {
                id: 'presens1',
                title: "Presens - Nutid (Set 1)",
                questions: [
                    { q: "Mis amigos _____ un libro.", hint: "(skriva)", answer: "escriben" },
                    { q: "Vosotros _____ a EspaÃ±a.", hint: "(Ã¥ka)", answer: "vais" },
                    { q: "Por quÃ© no _____ ustedes?", hint: "(Ã¤ta)", answer: "comen" },
                    { q: "Ana y yo _____ el texto.", hint: "(lÃ¤sa)", answer: "leemos" },
                    { q: "Los niÃ±os _____ mucho.", hint: "(frÃ¥ga)", answer: "preguntan" },
                    { q: "Â¿QuÃ© _____ tÃº?", hint: "(sÃ¤ga)", answer: "dices" },
                    { q: "Yo _____ la ciudad.", hint: "(kÃ¤nna till)", answer: "conozco" }
                ]
            },
            {
                id: 'diftong',
                title: "Presens - Diftongerande verb",
                questions: [
                    { q: "Yo _____ en la escuela.", hint: "(tÃ¤nka)", answer: "pienso" },
                    { q: "MarÃ­a y tÃº _____ al tenis.", hint: "(spela)", answer: "jugÃ¡is" },
                    { q: "TÃº _____ todo el dÃ­a.", hint: "(sova)", answer: "duermes" },
                    { q: "Vosotras _____ tarde.", hint: "(bÃ¶rja)", answer: "empezÃ¡is" },
                    { q: "TÃº y yo _____ la puerta.", hint: "(stÃ¤nga)", answer: "cerramos" },
                    { q: "Pablo _____ la mÃºsica pop.", hint: "(fÃ¶redra)", answer: "prefiere" },
                    { q: "Usted _____ estudiar mucho.", hint: "(bruka)", answer: "suele" },
                    { q: "Nosotros _____ hablar maÃ±ana.", hint: "(kunna)", answer: "podemos" },
                    { q: "Â¿Ustedes _____ sueco?", hint: "(fÃ¶rstÃ¥)", answer: "entienden" },
                    { q: "Â¿Vosotros _____ estudiar?", hint: "(vilja)", answer: "querÃ©is" },
                    { q: "TÃº _____ a las siete.", hint: "(Ã¥tervÃ¤nda)", answer: "vuelves" }
                ]
            },
            {
                id: 'perfekt1',
                title: "Perfekt - DÃ¥tid (Set 1)",
                questions: [
                    { q: "TÃº _____ la tele, Â¿no?", hint: "(se)", answer: "has visto" },
                    { q: "Pedro _____ muchas novelas.", hint: "(lÃ¤sa)", answer: "ha leÃ­do" },
                    { q: "Yo _____ en casa.", hint: "(vÃ¤nta)", answer: "he esperado" },
                    { q: "Ustedes _____ mucho chocolate.", hint: "(kÃ¶pa)", answer: "han comprado" },
                    { q: "Carmen _____ cada noche.", hint: "(gÃ¥ ut)", answer: "ha salido" },
                    { q: "Vosotros _____ un libro.", hint: "(skriva)", answer: "habÃ©is escrito" },
                    { q: "Las chicas _____ a Madrid.", hint: "(Ã¥ka)", answer: "han ido" },
                    { q: "Alberto y yo _____ suerte.", hint: "(ha)", answer: "hemos tenido" },
                    { q: "Â¿QuÃ© _____ los niÃ±os?", hint: "(gÃ¶ra)", answer: "han hecho" }
                ]
            },
            {
                id: 'futurum1',
                title: "Futurum - Framtid (Set 1)",
                questions: [
                    { q: "El hombre _____ sueco.", hint: "(lyssna)", answer: "va a escuchar" },
                    { q: "Mi amigo y yo _____ tarde.", hint: "(Ã¥tervÃ¤nda)", answer: "vamos a volver" },
                    { q: "La profesora _____ la puerta.", hint: "(stÃ¤nga)", answer: "va a cerrar" },
                    { q: "Ustedes _____ ahora.", hint: "(gÃ¥ ut)", answer: "van a salir" },
                    { q: "Yo _____ una montaÃ±a.", hint: "(gÃ¥ upp)", answer: "voy a subir" }
                ]
            },
            {
                id: 'gerundium1',
                title: "Gerundium - PÃ¥gÃ¥endeform (Set 1)",
                questions: [
                    { q: "Usted _____ mucho.", hint: "(arbeta)", answer: "estÃ¡ trabajando" },
                    { q: "TÃº _____ agua.", hint: "(dricka)", answer: "estÃ¡s bebiendo/estÃ¡s tomando" },
                    { q: "Las chicas _____ algo.", hint: "(fÃ¶rklara)", answer: "estÃ¡n explicando" },
                    { q: "Â¿QuÃ© _____ ustedes?", hint: "(gÃ¶ra)", answer: "estÃ¡n haciendo" },
                    { q: "Yo _____ en un hotel.", hint: "(bo)", answer: "estoy viviendo" },
                    { q: "Ã‰l _____ mucho.", hint: "(fÃ¶rstÃ¥)", answer: "estÃ¡ entendiendo/estÃ¡ comprendiendo" },
                    { q: "Nosotros _____ fÃºtbol.", hint: "(trÃ¤na)", answer: "estamos entrenando" }
                ]
            },
            {
                id: 'presens2',
                title: "Presens - Nutid (Set 2)",
                questions: [
                    { q: "Mis hermanos _____ a su madre.", hint: "(hjÃ¤lpa)", answer: "ayudan" },
                    { q: "Nosotros _____ una carta.", hint: "(skriva)", answer: "escribimos" },
                    { q: "TÃº _____ a Bolivia.", hint: "(Ã¥ka)", answer: "vas" },
                    { q: "Julia y tÃº _____ un libro.", hint: "(lÃ¤sa)", answer: "leÃ©is" },
                    { q: "Yo _____ EspaÃ±a bien.", hint: "(kÃ¤nna till)", answer: "conozco" },
                    { q: "Antonio _____ a un volcÃ¡n.", hint: "(gÃ¥ upp)", answer: "sube" },
                    { q: "Mi novio _____ de Argentina.", hint: "(vara)", answer: "es" },
                    { q: "Ella _____ en mÃ­.", hint: "(tro)", answer: "cree" }
                ]
            },
            {
                id: 'perfekt2',
                title: "Perfekt - DÃ¥tid (Set 2)",
                questions: [
                    { q: "La chica _____ inglÃ©s.", hint: "(prata)", answer: "ha hablado" },
                    { q: "Â¿TÃº no _____ los deberes?", hint: "(gÃ¶ra)", answer: "has hecho" },
                    { q: "Yo _____ 'hola'.", hint: "(sÃ¤ga)", answer: "he dicho" },
                    { q: "Mis hijos _____ el telÃ©fono.", hint: "(svara)", answer: "han contestado" },
                    { q: "Ustedes _____ la puerta.", hint: "(Ã¶ppna)", answer: "han abierto" },
                    { q: "Juan _____ agua.", hint: "(dricka)", answer: "ha bebido/ha tomado" },
                    { q: "Nosotros _____ mucho.", hint: "(vÃ¤nta)", answer: "hemos esperado" },
                    { q: "Â¿Usted _____ algo?", hint: "(bestÃ¤mma)", answer: "ha decidido" },
                    { q: "Tu padre _____ una carta.", hint: "(skriva)", answer: "ha escrito" },
                    { q: "Vosotros _____ la tele.", hint: "(se)", answer: "habÃ©is visto" }
                ]
            },
            {
                id: 'futurum2',
                title: "Futurum - Framtid (Set 2)",
                questions: [
                    { q: "Yo _____ en la casa.", hint: "(fÃ¶rklara)", answer: "voy a explicar" },
                    { q: "Ustedes _____ al fÃºtbol.", hint: "(spela)", answer: "van a jugar" },
                    { q: "Ella _____ a EspaÃ±a.", hint: "(komma fram)", answer: "va a llegar" },
                    { q: "TÃº _____ un texto.", hint: "(skriva)", answer: "vas a escribir" },
                    { q: "Nosotros _____ maÃ±ana.", hint: "(gÃ¥ ut)", answer: "vamos a salir" }
                ]
            },
            {
                id: 'gerundium2',
                title: "Gerundium - PÃ¥gÃ¥endeform (Set 2)",
                questions: [
                    { q: "Ustedes _____ mucho.", hint: "(studera)", answer: "estÃ¡n estudiando" },
                    { q: "Yo _____ pan.", hint: "(Ã¤ta)", answer: "estoy comiendo" },
                    { q: "Nosotros _____ adiÃ³s.", hint: "(sÃ¤ga)", answer: "estamos diciendo" },
                    { q: "Â¿AdÃ³nde _____ usted?", hint: "(Ã¥ka)", answer: "estÃ¡ yendo" },
                    { q: "TÃº _____ en un hotel.", hint: "(bo)", answer: "estÃ¡s viviendo" },
                    { q: "Ellos _____ una pelÃ­cula.", hint: "(se)", answer: "estÃ¡n viendo" },
                    { q: "Vosotros _____ revistas.", hint: "(lÃ¤sa)", answer: "estÃ¡is leyendo" },
                    { q: "Mis padres _____ mucho.", hint: "(arbeta)", answer: "estÃ¡n trabajando" },
                    { q: "Ella _____ la ventana.", hint: "(Ã¶ppna)", answer: "estÃ¡ abriendo" }
                ]
            }
        ];
        
        const translationExercises = [
            {
                id: 'translations',
                title: "Ã–versÃ¤ttningar svenska-spanska",
                questions: [
                    { q: "Hur Ã¤r ert schema? Vad tycker ni?", answer: "Â¿CÃ³mo es vuestro horario? Â¿QuÃ© pensÃ¡is?" },
                    { q: "Jag tycker att det Ã¤r ganska dÃ¥ligt.", answer: "Pienso que es bastante malo." },
                    { q: "HÃ¥ller du med? Gillar du det inte?", answer: "Â¿EstÃ¡s de acuerdo? Â¿No te gusta?" },
                    { q: "Jag tycker det Ã¤r bÃ¤ttre att bÃ¶rja tidigt.", answer: "Pienso que es mejor empezar temprano." },
                    { q: "Vi fÃ¶redrar att sluta sent och inte ha lÃ¤xor.", answer: "Preferimos terminar tarde y no tener deberes." },
                    { q: "Jag skulle vilja sluta tidigare varje dag.", answer: "Me gustarÃ­a terminar mÃ¡s temprano todos los dÃ­as." },
                    { q: "Brukar du spela tennis med dina kompisar?", answer: "Â¿Sueles jugar (al) tenis con tus amigos?" },
                    { q: "Nu hÃ¥ller vi pÃ¥ att prata om nÃ¤r vi ska spela.", answer: "Ahora estamos hablando de cuÃ¡ndo vamos a jugar." },
                    { q: "Vill ni spela tennis i helgen?", answer: "Â¿QuerÃ©is jugar (al) tenis este fin de semana?" },
                    { q: "Vilken dag fÃ¶redrar ni att spela?", answer: "Â¿QuÃ© dÃ­a preferÃ­s jugar?" },
                    { q: "Vi tycker det Ã¤r bÃ¤ttre om vi spelar pÃ¥ lÃ¶rdag.", answer: "Pensamos que es mejor si jugamos el sÃ¡bado." },
                    { q: "Du kan gÃ¥ till festen efterÃ¥t.", answer: "Puedes ir a la fiesta despuÃ©s." },
                    { q: "Spelar du inte med din mamma pÃ¥ sÃ¶ndagar?", answer: "Â¿No juegas con tu madre los domingos?" },
                    { q: "Ibland ja, men den hÃ¤r helgen kan hon inte, hon mÃ¥ste jobba.", answer: "A veces sÃ­, pero este fin de semana no puede, tiene que trabajar." },
                    { q: "Vad har Julia sagt? Kan hon spela?", answer: "Â¿QuÃ© ha dicho Julia? Â¿Puede jugar?" },
                    { q: "Men vilken tid trÃ¤ffas vi? Klockan halv ett?", answer: "Â¿Pero a quÃ© hora quedamos? Â¿A las doce y media?" },
                    { q: "Vilken trÃ¥kig lektion! Vi gÃ¥r till cafeterian.", answer: "Â¡QuÃ© clase mÃ¡s aburrida! Vamos a la cafeterÃ­a." },
                    { q: "Jag har lust att Ã¤ta nÃ¥got. Jag Ã¤r alltid hungrig.", answer: "Tengo ganas de comer algo. Siempre tengo hambre." },
                    { q: "Kaffe med mjÃ¶lk! Vad gott!", answer: "Â¡CafÃ© con leche! Â¡QuÃ© rico!" },
                    { q: "Jag fÃ¶rstÃ¥r inte varfÃ¶r vi mÃ¥ste plugga sÃ¥ mycket. Det Ã¤r sÃ¥ trÃ¥kigt.", answer: "No entiendo por quÃ© tenemos que estudiar tanto. Es tan aburrido." },
                    { q: "Men fÃ¶r mig Ã¤r skolan viktig.", answer: "Pero para mÃ­ el colegio es importante." },
                    { q: "Jag vill fÃ¥ bra betyg och komma in pÃ¥ nÃ¥got gymnasium.", answer: "Quiero sacar buenas notas y entrar en algÃºn instituto." },
                    { q: "Jag skulle vilja tjÃ¤na tillrÃ¤ckligt med pengar.", answer: "Me gustarÃ­a ganar suficiente dinero." },
                    { q: "VarfÃ¶r vill du tjÃ¤na sÃ¥ mycket pengar? Vill du kÃ¶pa en bil?", answer: "Â¿Por quÃ© quieres ganar tanto dinero? Â¿Quieres comprar un coche?" },
                    { q: "Vad tycker du? Vad Ã¤r det viktigaste fÃ¶r dig?", answer: "Â¿QuÃ© piensas? Â¿QuÃ© es lo mÃ¡s importante para ti?" },
                    { q: "Vad skulle du vilja gÃ¶ra i framtiden?", answer: "Â¿QuÃ© te gustarÃ­a hacer en el futuro?" },
                    { q: "Jag vill gÃ¶ra nÃ¥got viktigt men jag vet inte vad.", answer: "Quiero hacer algo importante pero no sÃ© quÃ©." },
                    { q: "Vill du resa och lÃ¤ra kÃ¤nna folk frÃ¥n andra delar av vÃ¤rlden?", answer: "Â¿Quieres viajar y conocer gente de otras partes del mundo?" },
                    { q: "Jag skulle ocksÃ¥ vilja bo och arbeta i ett annat land.", answer: "TambiÃ©n me gustarÃ­a vivir y trabajar en otro paÃ­s." },
                    { q: "Med vad skulle du vilja jobba?", answer: "Â¿Con quÃ© te gustarÃ­a trabajar?" },
                    { q: "Jag vill kanske bli lÃ¤kare och dÃ¤rfÃ¶r mÃ¥ste jag fÃ¥ bra betyg.", answer: "QuizÃ¡s quiero ser mÃ©dico y por eso tengo que sacar buenas notas." },
                    { q: "Om fem Ã¥r kommer jag tjÃ¤na mer pengar Ã¤n alla ni tillsammans.", answer: "En cinco aÃ±os voy a ganar mÃ¡s dinero que todos vosotros juntos." }
                ]
            }
        ];
        
        function selectMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }
        
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }
        
        function backToMenu() {
            showScreen('menuScreen');
            resetStats();
        }
        
        function selectAll() {
            document.querySelectorAll('#sectionList input[type="checkbox"]').forEach(cb => cb.checked = true);
        }
        
        function deselectAll() {
            document.querySelectorAll('#sectionList input[type="checkbox"]').forEach(cb => cb.checked = false);
        }
        
        function loadSections() {
            const sections = currentMode === 'verbs' ? verbExercises : translationExercises;
            const listContainer = document.getElementById('sectionList');
            listContainer.innerHTML = '';
            
            sections.forEach(section => {
                const div = document.createElement('div');
                div.className = 'section-checkbox';
                div.innerHTML = `
                    <input type="checkbox" id="section-${section.id}" value="${section.id}">
                    <label for="section-${section.id}">${section.title} (${section.questions.length} frÃ¥gor)</label>
                `;
                listContainer.appendChild(div);
            });
        }
        
        document.querySelectorAll('.mode-btn')[0].addEventListener('click', function() {
            loadSections();
            showScreen('selectionScreen');
        });
        
        document.querySelectorAll('.mode-btn')[1].addEventListener('click', function() {
            loadSections();
            showScreen('selectionScreen');
        });
        
        function startExercise() {
            const checkboxes = document.querySelectorAll('#sectionList input[type="checkbox"]:checked');
            
            if (checkboxes.length === 0) {
                alert('VÃ¤lj minst en Ã¶vningssektion!');
                return;
            }
            
            selectedSections = Array.from(checkboxes).map(cb => cb.value);
            
            currentQuestions = [];
            const sections = currentMode === 'verbs' ? verbExercises : translationExercises;
            
            sections.forEach(section => {
                if (selectedSections.includes(section.id)) {
                    section.questions.forEach(q => {
                        currentQuestions.push({
                            ...q,
                            sectionTitle: section.title
                        });
                    });
                }
            });
            
            currentQuestionIndex = 0;
            resetStats();
            stats.total = currentQuestions.length;
            
            showScreen('exerciseScreen');
            loadQuestion();
        }
        
        function resetStats() {
            stats = {
                total: 0,
                correct: 0,
                wrong: 0,
                firstTry: 0,
                wrongQuestions: []
            };
        }
        
        function loadQuestion() {
            if (currentQuestionIndex >= currentQuestions.length) {
                showResults();
                return;
            }
            
            const question = currentQuestions[currentQuestionIndex];
            attempts = 0;
            
            document.getElementById('progressText').textContent = 
                `FrÃ¥ga ${currentQuestionIndex + 1} av ${currentQuestions.length}`;
            document.getElementById('progressFill').style.width = 
                `${((currentQuestionIndex) / currentQuestions.length) * 100}%`;
            
            document.getElementById('questionSection').textContent = question.sectionTitle;
            document.getElementById('questionText').textContent = question.q;
            document.getElementById('questionHint').textContent = question.hint || '';
            document.getElementById('questionHint').style.display = question.hint ? 'block' : 'none';
            
            document.getElementById('answerInput').value = '';
            document.getElementById('answerInput').className = 'answer-input';
            document.getElementById('answerInput').disabled = false;
            document.getElementById('answerInput').focus();
            
            document.getElementById('feedback').className = 'feedback';
            document.getElementById('attemptsText').textContent = 'FÃ¶rsÃ¶k 1 av 2';
            
            document.getElementById('checkBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').style.display = 'none';
        }
        
        function normalizeText(text) {
            return text.toLowerCase()
                .trim()
                .replace(/\s+/g, ' ')
                .replace(/[Â¿?Â¡!.]/g, '')
                .replace(/\(al\)/g, '')
                .replace(/al/g, '')
                .replace(/\(/g, '')
                .replace(/\)/g, '');
        }
        
        function checkAnswer() {
            attempts++;
            
            const userAnswer = normalizeText(document.getElementById('answerInput').value);
            const question = currentQuestions[currentQuestionIndex];
            const correctAnswers = question.answer.toLowerCase().split('/').map(a => normalizeText(a));
            
            const isCorrect = correctAnswers.some(answer => userAnswer === answer);
            
            if (isCorrect) {
                document.getElementById('answerInput').className = 'answer-input correct';
                document.getElementById('feedback').className = 'feedback correct show';
                document.getElementById('feedback').innerHTML = 'âœ“ <strong>RÃ¤tt!</strong> Bra jobbat!';
                
                stats.correct++;
                if (attempts === 1) {
                    stats.firstTry++;
                }
                
                document.getElementById('checkBtn').style.display = 'none';
                document.getElementById('nextBtn').style.display = 'inline-block';
                document.getElementById('answerInput').disabled = true;
            } else {
                if (attempts >= 2) {
                    document.getElementById('answerInput').className = 'answer-input incorrect';
                    document.getElementById('feedback').className = 'feedback incorrect show';
                    document.getElementById('feedback').innerHTML = 
                        `âœ— <strong>TyvÃ¤rr!</strong><br>RÃ¤tt svar: <strong>${question.answer}</strong>`;
                    
                    stats.wrong++;
                    stats.wrongQuestions.push({...question, index: currentQuestionIndex});
                    
                    document.getElementById('checkBtn').style.display = 'none';
                    document.getElementById('nextBtn').style.display = 'inline-block';
                    document.getElementById('answerInput').disabled = true;
                } else {
                    document.getElementById('answerInput').className = 'answer-input incorrect';
                    document.getElementById('feedback').className = 'feedback incorrect show';
                    document.getElementById('feedback').innerHTML = 'âœ— <strong>Fel svar.</strong> FÃ¶rsÃ¶k igen!';
                    document.getElementById('attemptsText').textContent = 'FÃ¶rsÃ¶k 2 av 2';
                    document.getElementById('answerInput').select();
                }
            }
        }
        
        function nextQuestion() {
            currentQuestionIndex++;
            loadQuestion();
        }
        
        function showResults() {
            const percentage = Math.round((stats.correct / stats.total) * 100);
            
            document.getElementById('resultsScore').textContent = `${percentage}%`;
            
            let message = '';
            if (percentage === 100) {
                message = 'ðŸŽ‰ Perfekt! Du Ã¤r en stjÃ¤rna!';
            } else if (percentage >= 80) {
                message = 'ðŸ‘ Bra jobbat! FortsÃ¤tt sÃ¥!';
            } else if (percentage >= 60) {
                message = 'ðŸ’ª Du Ã¤r pÃ¥ rÃ¤tt vÃ¤g!';
            } else {
                message = 'ðŸ“š FortsÃ¤tt Ã¶va sÃ¥ blir det bÃ¤ttre!';
            }
            document.getElementById('resultsMessage').textContent = message;
            
            document.getElementById('totalQuestions').textContent = stats.total;
            document.getElementById('correctAnswers').textContent = stats.correct;
            document.getElementById('wrongAnswers').textContent = stats.wrong;
            document.getElementById('firstTryCorrect').textContent = stats.firstTry;
            
            const restartWrongBtn = document.getElementById('restartWrongBtn');
            if (stats.wrongQuestions.length > 0) {
                restartWrongBtn.style.display = 'inline-block';
            } else {
                restartWrongBtn.style.display = 'none';
            }
            
            showScreen('resultsScreen');
        }
        
        function restartAll() {
            startExercise();
        }
        
        function restartWrong() {
            if (stats.wrongQuestions.length === 0) {
                alert('Inga fel att Ã¶va pÃ¥!');
                return;
            }
            
            currentQuestions = [...stats.wrongQuestions];
            currentQuestionIndex = 0;
            resetStats();
            stats.total = currentQuestions.length;
            
            showScreen('exerciseScreen');
            loadQuestion();
        }
        
        document.getElementById('answerInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                if (document.getElementById('checkBtn').style.display !== 'none') {
                    checkAnswer();
                } else {
                    nextQuestion();
                }
            }
        });
        
        // Initialize mode buttons with proper event listeners
        document.querySelectorAll('.mode-btn').forEach((btn, index) => {
            btn.addEventListener('click', function() {
                selectMode(index === 0 ? 'verbs' : 'translations');
                loadSections();
                showScreen('selectionScreen');
            });
        });
    </script>
</body>
</html>
